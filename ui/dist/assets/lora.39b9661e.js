import{a as e}from"./index.2cf0d985.js";import{f as a,g as t,h as s,p as l,j as n,r as i,o as c,k as r,l as o,m as d,w as p,F as u,n as v,c as g,q as y,t as k}from"./vendor.7e9e41ae.js";var m=a({setup(a,l){e.defaults.headers.post["Content-Type"]="application/json";const n=t(""),i=t(""),c=t(""),r=()=>{var e=new Date,a=e.getHours(),t=e.getMinutes(),s=e.getSeconds();return`${a<10?"0"+a:a}:${t<10?"0"+t:t}:${s<10?"0"+s:s}`},o=s({apis:Array(),bridges:Array(),locks:Array()});localStorage.getItem("apis22")&&(o.apis=JSON.parse(localStorage.getItem("apis22"))),localStorage.getItem("bridges22")&&(o.bridges=JSON.parse(localStorage.getItem("bridges22"))),localStorage.getItem("locks22")&&(o.locks=JSON.parse(localStorage.getItem("locks22")));const d=t(""),p=t(""),u=t(""),v=t(""),g=()=>{const e=document.querySelector(".logs");return null!=e?e:new HTMLDivElement};return{saveKey:()=>{o.apis.push(n.value),localStorage.setItem("apis22",JSON.stringify(o.apis))},saveBridge:()=>{o.bridges.push(i.value),localStorage.setItem("bridges22",JSON.stringify(o.bridges))},saveLock:()=>{o.locks.push(c.value),localStorage.setItem("locks22",JSON.stringify(o.locks))},apiKey:n,bridgeId:i,lockId:c,apiKeySelect:d,bridgeIdSelect:p,lockIdSelect:u,data:o,message:v,connWS:()=>{var e="ws://"+location.hostname+":"+location.port,a=new WebSocket(`${e}/v2/ttn/websocket?token=${d.value}&applicationId=${p.value}&deviceId=${u.value}`);a.onopen=e=>{g().innerHTML=`<p class="time">WebSocket Open ${r()}</p><p style="color:red">${JSON.stringify(e)}</p>`+g().innerHTML},a.onerror=e=>{g().innerHTML=`<p class="time">WebSocket Error ${r()}</p><p style="color:red">${JSON.stringify(e)}</p>`+g().innerHTML},a.onclose=e=>{g().innerHTML=`<p class="time">WebSocket Close ${r()}</p><p style="color:red">${JSON.stringify(e)}</p>`+g().innerHTML},a.onmessage=e=>{try{const i=JSON.parse(e.data);var a=new Date(i.result.time),t=a.getHours(),s=a.getMinutes(),l=a.getSeconds();const c=`<p style="color:green">${`${t<10?"0"+t:t}:${s<10?"0"+s:s}:${l<10?"0"+l:l}`} ${i.result.identifiers[0].device_ids.dev_eui}:${i.result.identifiers[0].device_ids.dev_addr} FPort=${i.result.data.uplink_message.f_port} FrmPayload=${n=atob(i.result.data.uplink_message.frm_payload),n.indexOf("AT+BATTERY")>-1||n.indexOf("AT+STATUS")>-1?`<b style="font-size:18px;color:#f00;">${n}</b>`:n}</p>`;g().innerHTML=c+g().innerHTML}catch{g().innerHTML=`<p class="time">WebSocket Message ${r()}</p><p style="color:red">${JSON.stringify(e.data)}</p>`+g().innerHTML}var n},setInterval((()=>{a.send("")}),6e4)},clearLogs:()=>{g().innerText=""},sendMessage:()=>{const a=r();e.post("/v2/ttn/sendMessage",{apiKey:d.value,applicationId:p.value,deviceId:u.value,data:btoa(v.value)}).then((e=>{g().innerHTML=`<p class="time">sendMessage ${a}-${r()}</p>`+e.data+g().innerHTML})).catch((e=>{g().innerHTML=`<p class="time">sendMessage ${a}-${r()}</p><p style="color:red">${JSON.stringify(e)}</p>`+g().innerHTML}))},fnLock:()=>{const a=r();e.post("/v2/ttn/sendMessage",{apiKey:d.value,applicationId:p.value,deviceId:u.value,data:btoa("+LOCK\r\n")}).then((e=>{g().innerHTML=`<p class="time">LOCK ${a}-${r()}</p>`+e.data+g().innerHTML})).catch((e=>{g().innerHTML=`<p class="time">LOCK ${a}-${r()}</p><p style="color:red">${JSON.stringify(e)}</p>`+g().innerHTML}))},fnUnlock:()=>{const a=r();e.post("/v2/ttn/sendMessage",{apiKey:d.value,applicationId:p.value,deviceId:u.value,data:btoa("+UNLOCK\r\n")}).then((e=>{g().innerHTML=`<p class="time">UNLOCK ${a}-${r()}</p>`+e.data+g().innerHTML})).catch((e=>{g().innerHTML=`<p class="time">UNLOCK ${a}-${r()}</p><p style="color:red">${JSON.stringify(e)}</p>`+g().innerHTML}))},fnBattery:()=>{const a=r();e.post("/v2/ttn/sendMessage",{apiKey:d.value,applicationId:p.value,deviceId:u.value,cmd:"battery",data:btoa("+BATTERY\r\n")}).then((e=>{g().innerHTML=`<p class="time">BATTERY ${a}-${r()}</p>`+e.data+g().innerHTML})).catch((e=>{g().innerHTML=`<p class="time">BATTERY ${a}-${r()}</p><p style="color:red">${JSON.stringify(e)}</p>`+g().innerHTML}))},fnState:()=>{const a=r();e.post("/v2/ttn/sendMessage",{apiKey:d.value,applicationId:p.value,deviceId:u.value,cmd:"state",data:btoa("+STATUS\r\n")}).then((e=>{g().innerHTML=`<p class="time">STATUS ${a}-${r()}</p>`+e.data+g().innerHTML})).catch((e=>{g().innerHTML=`<p class="time">STATUS ${a}-${r()}</p><p style="color:red">${JSON.stringify(e)}</p>`+g().innerHTML}))},fnMessage:()=>{const a=r();e.post("/v2/ttn/message",{apiKey:d.value,applicationId:p.value,deviceId:u.value,data:btoa("AT+STATUS")}).then((e=>{g().innerHTML=`<p class="time">STATUS ${a}-${r()}</p>`+e.data+g().innerHTML})).catch((e=>{g().innerHTML=`<p class="time">STATUS ${a}-${r()}</p><p style="color:red">${JSON.stringify(e)}</p>`+g().innerHTML}))}}}});l("data-v-144a809d");const S={class:"main"},T={class:"model"},f=y("添加 API Key"),$={class:"model"},M=y("添加 ApplicationID"),L={class:"model"},I=y("添加 DeviceID"),H={class:"model"},b={class:"model"},h={class:"model"},C={class:"model"},O=y("发送消息"),_={class:"model"},K=y("开锁"),N=y("上锁"),A=y("查询电量"),U=y("查询状态"),J=y("连接WebSocket"),w=y("清理日志"),z={class:"logs",ref:"logs"};n(),m.render=function(e,a,t,s,l,n){const m=i("v-input"),V=i("v-btn"),B=i("v-radio");return c(),r("div",S,[o("div",T,[d(m,{class:"m-left",type:"warn",value:e.apiKey,"onUpdate:value":a[0]||(a[0]=a=>e.apiKey=a)},null,8,["value"]),d(V,{class:"m-right",type:"warn",size:"large",onClick:e.saveKey},{default:p((()=>[f])),_:1},8,["onClick"])]),o("div",$,[d(m,{class:"m-left",type:"warn",value:e.bridgeId,"onUpdate:value":a[1]||(a[1]=a=>e.bridgeId=a)},null,8,["value"]),d(V,{class:"m-right",type:"warn",size:"large",onClick:e.saveBridge},{default:p((()=>[M])),_:1},8,["onClick"])]),o("div",L,[d(m,{class:"m-left",type:"warn",value:e.lockId,"onUpdate:value":a[2]||(a[2]=a=>e.lockId=a)},null,8,["value"]),d(V,{class:"m-right",type:"warn",size:"large",onClick:e.saveLock},{default:p((()=>[I])),_:1},8,["onClick"])]),o("div",H,[(c(!0),r(u,null,v(e.data.apis,((t,s)=>(c(),g(B,{key:s,type:"success",value:t,checkedValue:e.apiKeySelect,"onUpdate:checkedValue":a[3]||(a[3]=a=>e.apiKeySelect=a)},{default:p((()=>[y(k(t),1)])),_:2},1032,["value","checkedValue"])))),128))]),o("div",b,[(c(!0),r(u,null,v(e.data.bridges,((t,s)=>(c(),g(B,{key:s,type:"pink",value:t,checkedValue:e.bridgeIdSelect,"onUpdate:checkedValue":a[4]||(a[4]=a=>e.bridgeIdSelect=a)},{default:p((()=>[y(k(t),1)])),_:2},1032,["value","checkedValue"])))),128))]),o("div",h,[(c(!0),r(u,null,v(e.data.locks,((t,s)=>(c(),g(B,{key:s,type:"purple",value:t,checkedValue:e.lockIdSelect,"onUpdate:checkedValue":a[5]||(a[5]=a=>e.lockIdSelect=a)},{default:p((()=>[y(k(t),1)])),_:2},1032,["value","checkedValue"])))),128))]),o("div",C,[d(m,{class:"m-left",type:"success",value:e.message,"onUpdate:value":a[6]||(a[6]=a=>e.message=a)},null,8,["value"]),d(V,{class:"m-right",type:"success",size:"large",onClick:e.sendMessage},{default:p((()=>[O])),_:1},8,["onClick"])]),o("div",_,[d(V,{size:"large",type:"purple",onClick:e.fnLock},{default:p((()=>[K])),_:1},8,["onClick"]),d(V,{size:"large",type:"purple",onClick:e.fnUnlock},{default:p((()=>[N])),_:1},8,["onClick"]),d(V,{size:"large",type:"purple",onClick:e.fnBattery},{default:p((()=>[A])),_:1},8,["onClick"]),d(V,{size:"large",type:"purple",onClick:e.fnState},{default:p((()=>[U])),_:1},8,["onClick"]),d(V,{size:"large",type:"purple",onClick:e.connWS},{default:p((()=>[J])),_:1},8,["onClick"]),d(V,{size:"large",onClick:e.clearLogs},{default:p((()=>[w])),_:1},8,["onClick"])]),o("div",z,null,512)])},m.__scopeId="data-v-144a809d";export{m as default};
